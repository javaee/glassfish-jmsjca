<?xml version="1.0"?>
<project default="" basedir="." name="sunone">
    <import file="build-common.xml" />
    <taskdef name="if" classname="net.sf.antcontrib.logic.IfTask" classpath="./buildtools/lib/ant-contrib.jar"/>
    <taskdef name="switch" classname="net.sf.antcontrib.logic.Switch" classpath="./buildtools/lib/ant-contrib.jar"/>

<!--===========================================================================
    Initializes variables etc
-->
    <target name="init" unless="init.ed">
        <!-- To compile/run unit tests -->
        <path id="jmsjca.test.classpath">
            <path refid="container.classpath"/>
            <fileset file="core/test/lib/jdom.jar" />
            <fileset file="${jmsjca.core.jar.path}" />
            <fileset file="${jmsjca.xxx.rar.jar.path}" />
            <pathelement location="${jmsjca.container.classes.dir}" />

            <fileset file="${jcaid}/lib/imqjmsra.jar" />
            <fileset file="jndi/test/lib/fscontext.jar" />
            <fileset file="jndi/test/lib/providerutil.jar" />
        </path>

        <property name="init.ed" value="true" />
    </target>

<!--===========================================================================
    Creates the rar file
-->
    <target name="rar" depends="init" unless="rar.ed">
        <!-- Build the rar -->
        <mkdir dir="${jcaid}/lib" />
        <zip destfile="${jmsjca.xxx.rar.rar.path}" >
            <fileset file="${jmsjca.xxx.rar.jar.path}" />
            <fileset file="${jmsjca.core.jar.path}" />
            <fileset dir="${jcaid}/lib" >
                <include name="imqjmsra.jar" />
            </fileset>
            <zipfileset prefix="META-INF" file="${jcaid}/src/meta/ra.xml" />
        </zip>

        <property name="rar.ed" value="true" />
    </target>

</project>
